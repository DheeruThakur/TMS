Vagrant.configure("2") do |config|
  config.vm.define "web" do |fedora|
      fedora.vm.box = "jacobw/fedora35-arm64" 
      fedora.vm.hostname="web"
      fedora.vm.network "private_network", ip: "192.168.56.12"
      fedora.vm.provider "vmware_desktop" do |vmware|
        vmware.memory = "1600"
      end
      fedora.vm.provision "shell", inline: <<-SHELL
        yum update && yup upgrade -y
        dnf module install nodejs:16 -y
        yum install git -y
        git clone https://github.com/POOL4T7/TMS.git
  SHELL
  end

  config.vm.define "server" do |ubuntu|
      ubuntu.vm.box = "spox/ubuntu-arm" 
      ubuntu.vm.hostname = "server" 
      ubuntu.vm.box_version = "1.0.0"
      ubuntu.vm.network "private_network", ip: "192.168.56.11"
      ubuntu.vm.network "public_network"
      ubuntu.vm.provider "vmware_desktop" do |vmware|
          vmware.cpus="2"
          vmware.memory = "1600"
        end
      ubuntu.vm.provision "shell", inline: <<-SHELL
        echo "⚡️ Scanning the updating packages.."
        apt update > /dev/null
        echo "Scanning Done ✅"
        echo "⚡️⚡️ Updation the updating packages.."
        apt upgrade > /dev/null
        echo "Updating Done ✅" 
        echo "⚡️⚡️ Installing project Tools like Nodejs, NPM etc."
        sudo snap install node --channel=16/stable --classic
        echo "✅ Project Tools Installed successfully."
        echo "⚡️⚡️ Feching the code from cloud"
        git clone https://github.com/POOL4T7/TMS.git
        cd TMS/server
        echo "⚡️⚡️ Installing the server dpendency"
        npm install
        # cat <<EOT > .env
        #   PORT=8080
        #   NODE_ENV=development
        #   MONGO_URI=mongodb://gulshan:1alyxstar@localhost:27017/social?authSource=admin
        # EOT
        # echo "✅ Enviroment added successfully."
        npm run build
        npm start
        echo "⚡️⚡️ Server is started ⚡️⚡️"
    SHELL
  end
end
